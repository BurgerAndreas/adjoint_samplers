# @package _global_

defaults:
  - /problem: molecule
  - /source: harmonic # meanfree
  - /sde@ref_sde: graph_ve
  - /model@controller: egnn
  - /state_cost: zero
  - /term_cost: graph_corrector_term_cost
  - /matcher@adjoint_matcher: adjoint_ve
  - /model@corrector: egnn
  - /matcher@corrector_matcher: corrector

exp_name: isopropanol_asbs

gt_file: null # path to ground truth geometry sample for evaluation
gt_key: null # key to extract ground truth geometry from the file. can be a list of keys.

# === molecule configuration ===
# isopropanol: C3H8O (12 atoms)
molecule: c3h8o

# Override energy molecule parameter
energy:
  molecule: ${molecule}
  functional: DFTB0
  n_jobs: 10

# === source ===
scale: 2

# === sde ===
nfe: 200
sigma_max: 1
sigma_min: 0.001
rescale_t: null # quad, cosine

# === training ===
num_epochs: 5000
max_grad_E_norm: 100
adj_num_epochs_per_stage: 200
ctr_num_epochs_per_stage: 20

adjoint_matcher:
  buffer_size: 10000
  duplicates: 10
  resample_size: 1000
  num_epochs_per_stage: ${adj_num_epochs_per_stage}
  optim:
    lr: 1e-4
    weight_decay: 0

corrector_matcher:
  buffer_size: 10000
  duplicates: 10
  resample_size: 1000
  num_epochs_per_stage: ${ctr_num_epochs_per_stage}
  optim:
    lr: 1e-4
    weight_decay: 0

# Reduce batch sizes for SCINE (much more expensive than toy energies)
resample_batch_size: 64
train_batch_size: 64
eval_batch_size: 200
num_eval_samples: ${eval_batch_size}

# === eval & logging ===
use_wandb: true

