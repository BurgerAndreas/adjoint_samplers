# @package _global_

defaults:
  - /problem: dw2
  - /source: harmonic # meanfree
  - /sde@ref_sde: graph_ve
  - /model@controller: egnn
  - /state_cost: zero
  - /term_cost: graph_corrector_term_cost
  - /matcher@adjoint_matcher: adjoint_ve
  - /model@corrector: egnn
  - /matcher@corrector_matcher: corrector

exp_name: dw2_asbs

# === source ===
scale: 2


# === sde ===
nfe: 200
sigma_max: 1
sigma_min: 0.001 ## Use smaller sigma_max
rescale_t: null # quad, cosine


# === training ===
num_epochs: 5000
max_grad_E_norm: 100
adj_num_epochs_per_stage: 200
ctr_num_epochs_per_stage: 20

adjoint_matcher:
  buffer_size: 10000
  duplicates: 10
  resample_size: 1000
  num_epochs_per_stage: ${adj_num_epochs_per_stage}
  optim:
    lr: 1e-4
    weight_decay: 0

corrector_matcher:
  buffer_size: 10000
  duplicates: 10
  resample_size: 1000
  num_epochs_per_stage: ${ctr_num_epochs_per_stage}
  optim:
    lr: 1e-4
    weight_decay: 0


# === eval & logging ===
use_wandb: true

# plotting axis limits
energy_min: null
energy_max: null
dist_min: 0
dist_max: 10

draw_label_cutoff: 8.0
draw_label_max_pairs: 10
render_medoids_flat: true