# @package _global_

defaults:
  - /problem: lj55
  - /source: delta
  - /sde@ref_sde: graph_ve
  - /model@controller: egnn
  - /state_cost: zero
  - /term_cost: graph_score_term_cost
  - /matcher@adjoint_matcher: adjoint_ve

exp_name: lj55_as

# === sde ===
nfe: 1000
sigma_max: 2
sigma_min: 0.001 ## Use smaller sigma_max
rescale_t: null # quad, cosine


# === training ===
num_epochs: 4000
max_grad_E_norm: 100

resample_batch_size: 200
train_batch_size: 200
eval_batch_size: 1000
num_eval_samples: 2000

adjoint_matcher:
  buffer_size: 10000
  duplicates: 25
  resample_size: 200
  num_epochs_per_stage: ${num_epochs}
  optim:
    lr: 1e-4
    weight_decay: 0


# === eval & logging ===
use_wandb: true
eval_freq: 200
